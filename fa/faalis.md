فالیس چیست؟
==========
فالیس کتابخانه ای بر پایه ی بستر رویی آن ریلز است که با به کارگیری زبان برنامه نویسی روبی و ابزارهای مدرن و پر قدرتش ، توسعه نرم افزارهای وب را برای توسعه دهندگان هموار و سریع می سازد. 
فالیس ابزاری کاربردی است که توسط شرکت نرم افزای Yellowen از سال ۲۰۱۳ به دنیای نرم افزاری معرفی شده . این ابزار توانسته با قابلیت های خارق العاده خود ، امکان توسعه هر چه سریع تر و امن تر را به یک توسعه دهنده روبی آن ریلز ارائه دهد .
یکی از نکات این ابزار متن‌باز بودن آن و گسترش آن به صورت آزاد می‌باشد. این بدان معنی است که شما به راحتی می‌توانید به کد منبع آن دسترسی داشته باشید و به صورت رایگان از آن استفاده کنید و یا در گسترش آن همکاری کنید.
شاید برایتان کمی عجیب باشد که روبی آن ریلز خود پلتفرمی برای تسریع بخشیدن به ساخت پروژه است و چگونه ممکن است این ابزار  روبی آن ریلز حتی از خود روبی آن ریلز فرایند ساخت پروژه را سریع تر می تماید . اما باید بدانیم Faalis به شدت از تمامی ابزارهای ریلز سریعتر و خارق العاده تر است.
فالیس به شما این امکان را می دهد تا به وسیله روبی آن ریلز و پلاین های فالیس، یک وب اپلیکیشن شبیه یک CMS را در کوتاه ترین زمان داسته باشید . 
کوتاه ترین زمان به  این معنی است که فالیس قادر است دشبرد یا سیستم مدیریت اپلیکیشن شما را در زمان باور نکردنی به شکل اتوماتیک همراه با امکاناتی چون  Authentication ,  authorization , admin interface و مدیریت Blog , Menu و page بسازد که در ادامه به آن ها بیشتر خواهیم پرداخت.

امکانات و قابلیت‌های فالیس
-------------------------
فالیس امکانات و قابلیت ها جالبی رو در اختیار یک برنامه نویس Rails قرار می دهد .قابلیت هایی که شاید برای آماده سازی آن ها باید ساعت ها وقت بگذاریم . 
یک برنامه نویس همیشه مشکل زمان داشته است. این مشگل همیشه خیلی از فرصت ها را از یک برنامه نویس می گیرد .
فالیس از شروع تا به امروز سعی در آسان تر کردن فرایند برنامه نویسی توسط ریلز است ، ریلزی که در سرعت و قدرت ساخت یک وب اپلیکیشن زبان زد تمام توسعه دهندگان وب است و برای آن ها یک ابزار محبوب است . 
فالیس با توجه به اینکه بر روی ریلز سوار می شود توانسته قابلیت هایی بسیار قدرت مند را فراهم آورد که غبارتند از:

1. بخش کاربری
2. احراز هویت
3. سطوح دسترسی
4. resources
5. منو

### نصب فالیس بر روی پروژه
نصب و سوار کردن فالیس بر روی پروژه کار بسیار ساده ای است اما باید قبل از آن موارد زیر را رعایت کنید :
- ورژن روبی شما 2.2.2 و یا بالا تر باشد .
- اگر از ویندوز استفاده میکنید باید Ruby Installer مورد نظر را نصب کنید
- لازم است نحوه کار کردن RubyGems را در روبی و روبی آن ریلز بدانید .
- SQLite موجود در سیستم خود را راه اندازی کنید
پس از موارد ذکر شده ، بر ای نصب فالیس روی پروژه روبی آن ریلزتان ، لازم است موارد زیر را انجام دهیم:

1. در Gemfile پروژه روبی آن ریلزتان دستورات زیر را وارد نمایید.
```ruby
 source 'http://rails-assets.org' do
  gem 'rails-assets-sugar'
  gem 'rails-assets-bootstrap-rtl'
  gem 'rails-assets-jquery-knob'
  gem 'rails-assets-bootstrap-daterangepicker'
  gem 'rails-assets-jquery-sparkline'
  gem 'rails-assets-jquery-icheck'
  gem 'rails-assets-admin-lte'
end
 
gem "faalis"
```
2. سپس دستور زیر را برای نصب پلاگین های مورد نظر بر روی پروژه را اعمال نمایید
```{r, engine='bash', count_lines}
$ bundle install
```
3. برای تولید فالیس  از دستور زیر استفاده می کنند
```{r, engine='bash', count_lines}
$ rails g faalis:install
```
4. دستور زیر را در فایل "config/environments/development.rb" اضافه نمایید 
```
config.action_mailer.default_url_options = { :host => 'localhost:3000' }
```
5. برای ساخت و راه اندازی مدل اولیه دشبورد از کامد زیر استفاده نمایید
```{r, engine='bash', count_lines}
$ rake db:migrate db:seed
```
6. برای اطمینان از صحت فرایند نصب Faalis و مشاهده دشبورد ، پس اجرای آزماشی ریلز (rails server) توسط کامند لاین ، شما بایستی در Browser خود ادرس زیر را وارد کنید
```
localhost:3000/dashboard
```
7. اگر بدون هیچ مشگلی صفجه لاگین دشبورد را مشاهده فرمودید ، مطمئن باشید تمام مراحل را درست انجام داده اید . 
	برای ورود به دشبورد شما از username و password زیر استفاده کنید

```
Username: admin@example.com
Password: changeme
```
> شما شاهد بخش قدرت مندی از فایس هستید که به راحتی در اختیارتان قرار گرفته است. 

چگونه از فالیس استفاده کنیم
---------------------------
برای فهمیدن و یادگیری برنامه نویسی و توسعه هر ابزاری در دنیای کامپوتری لازم است پروژه ای در آن زمینه انجام دهیم تا به شکل عملی از فرایند ساخت و توسعه متطلع شویم.
شاید بهترین راه برای فهمیدن و یادگیری استفاده از فالیس ، دنبال کردن روند ساخت یک وب اپلیکیشن یا وب سایت باشد. در این بخش قصد داریم روند ساخت یک وبسایت خبری توسط فالیس و بستر ریلز را به شما ارائه دهیم . حس می کنیم این روش شما را بیشتر از هر روشی به شما کمک میکند تا ریلز و فالیس را با هم بشناسید .

ساخت یک سایت خبری
=================
در این سایت سعی داریم از دو روش برای ایجاد قسمت های مختلف پروژه استفاده کنیم . به این ترتیب که یکی از روش ها استفاده از فیوچر های فالیس می باشد و دیگری استفاده از قابلیت های ریلز . به هر ترتیب در پایان این بخش شما هر دو روش ساخت یک وبسایت خبر رسان را فرا خواهید گرفت. 

###ساخت مدل‌ 
برای ساخت مدل ها در ریلز و فالیس از روش های مشابهی استفاده میکنم و هر جا که روش متفاوتی بود آن را بیان می کنیم .

- ساخت مدل دسته بندی اخبار
```{r, engine='bash', count_lines}
$ rails generate model NewsCategory category_title:string description:text
```

- ساخت مدل اخبار
```{r, engine='bash', count_lines}
$ rails generate model Post title:string article:text news_category_id:integer
```
### ساخت دیتابیس و اطلاعات آزمایشی
برای ساخت دیتابیس ابتدا باید رابطه بین اجزای جدول ها را مشخص کنیم . در پروژه سایت خبری دو بخش news و news_category با هم در ارتباط هستند. 
به هر حال در این بخش به زبان ساده می توان گفت "هر news category دارای تعداد زیادی Post است". برای نوشتن این مفهوم به ادرس "app/models/news_category.rb" رفته و دستور زیر را در class موجود بنویسید.

```ruby
has_many :post
```
و در این بخش می توان گفت "تمام Post ها متعلق به یک category خاص است". برای نوشتن این مفهوم به آدرس "app/models/post.rb" رفته و دستور زیر را بین class موجود قرار دهید.
```ruby
belongs_to :news_category
```
برای تولید و ساخت دیتا بیس از دستور زیر استفاده می کنند.
```{r, engine='bash', count_lines}
$ rake db:migrate
```
### ساخت کنترلر سمت کاربر عادی
```{r, engine='bash', count_lines}
$ rails g controller post index show category
```
### ساخت ظاهر سمت بازدید عادی
1. پس از ساخت کنترل Post ، می بایست ظاهر آن سایت خود را بسازیم. میدانیم که بخش ایندکس بخش اصلی ما می باشد و باید به عنوان پیشفرض قرار گیرد. 
برای انجام این کار باید به آدرس "config>>routes.rb" رفته و دستور زیر را اضافه کرد. 

```ruby
root "post#index"
```
2. حال می خواهیم در بخش Index تمامی خبر ها را نمایش دهیم . که برای این کار ابتدا باید تمامی محتویات تیبل post را فراخوانی کنیم . برای انجام این کار به آدرس "app/controllers/post_controller.rb" رفته و در method مرتبط به Index دستور زیر را وارد کنید .
```ruby
def index
  @post = Post.all
end
```
3. برای بخش show و category باید نمایش بر اساس ID انجام شود . بنابر این در از این سبک برای هر کدام اشتفاده می کنیم .
```ruby
def show
   @news = Post.find(params[:id])
end

def category
   @news_category = NewsCategory.find(params(:id))
end
```
4. برای نشان دادن تمام خبر ها در قسمت Index باید به آدرس "app/views/post/index.html.slim" یا  "app/views/post/index.html.erb"(بسته به سلیقه تان) رفته و کد های زیر را با استاندارد های erb یا slim وارد نمایید .( ما از استاندارد erb استفاده کرده ایم).
```erb
<% @post.each do |item| %>
<div>
 <strong><%= item.title %></strong>
    <br>
 <div><%= item.article %></div>
     <br>
 <strong><%= item.writer %></strong>		    
</div>
<% end %>
```
سرور ریلز را run کنید تا و تنها آدرس localhost:3000 را در Browser خود وارد کنید . اگر بدون هیچ خطایی صفحه باز شد ، نشان دهنده آن است که شما تمام مراحل را درست انجام داده اید.

5. حال برای نمایش هر خبر در بخش های Show در موجود در "app>>views>>post>>show.html.erb" از دستوراتی مانند دستورات زیر استفاده می کنیم
```erb

```
 بعد از وارد کردن آن ها ، سرور را run کرده و به آدرس  localhost:3000/post/show توسط browser رفته و از صحت آن ها با خبر می شویم
 6. برای نمایش خبر ها از بر اساس کتگوری ها از دستور زیر موجود در "app>>views>>post>>category.html.erb" استفاده می کنیم
 ```erb
 
 ```
 و برای اطمینان از صحت فرایند انجام شده (همانند موارد قبل ) به آدرس "localhost:3000/post/category" رجوع کنید.

### استفاده از سازنده resource فالیس
همانگونه که می دانید قسمت داشبورد فالیس که در localhost:3000/dashboard قابل مشاهده است دارای گروه ها و سطوح دسترسی مختلف است که شامل بخش views و controllers پروژه جاری می شود. همچنین برای پیاده سازی CRUD در هر مدل، از دستوری مشابه "rails generate faalis:resource your_model" استفاده مینماییم .

به هر حال برای و عملی کردن CRUD در پروژه خبریمان لازم است دستورات زیر را در کامند لاین کنیم:
- اعمال CRUD بر روی مدل news_category
```{r, engine='bash', count_lines}
$ rails generate faalis:resource news_category
```
- اعمال CRUD بر روی مدل post
```{r, engine='bash', count_lines}
$ rails generate faalis:resource post
```
پس از وارد کردن این دستورات ، فالیس مدل و ساختار دیتابیس اشاره شده شما (post و news_category)  را فراخوانی می کند و موارد زیر را آماده سازی می کند.
1. سطوح دسترسی پیشفرض.
2. کنترلر مرتبط به بخش دشبورد.
3. ساختار اولیه بخش Test دشبورد.
4. اعمال آدرس های دشبورد در فایل Routes.

###آماده سازی منوی بخش کاربری
برای دسترسی به ریسورس تولید شده در دشبورد نیاز داریم تا منوی مربوطه را به فایل Application Controller در پوشه دشبورد اضافه کنیم (app/controllers/dashboard/application_controller.rb) .
```ruby
class Dashboard::ApplicationController < Faalis::Dashboard::ApplicationController

  def setup_sidebar
    @sidebar = sidebar('') do |s|
      s.faalis_entries
      s.menu(t('Post'), icon: 'fa fa-book') do
        s.item(t('Post'),
          url: main_app.dashboard_posts_path,
          model: 'Post')
        s.item(t('NewsCategory'),
          url: main_app.dashboard_news_categories_path,
          model: 'NewsCategory')
      end
    end
  end
end
```
### ترجمه بخش کاربری
برای ترجمه صحیح بخش کاربری از پلاگین یا gem اماده i18n استفاده کرده ایم که به صورت پیشفرض روی پروژه شما سوار شده است .
این پلاگین پلاین بسیار قدرت مند جهت ترجمه و بین المللی ساختن پروژه مورد استفاده قرار میگیرد که روند کامل یاد گیری آن در این آدرس قرار دارد.
اما به هر حال برای سریع و کارآمد آن می توان به این آدرس نیز مراجعه کرد که البته ما در اینجا برای شما قسمت های بسیاری از آن را برای پروژه خود توضیح خواهیم داد.
زبان هایی که این پلاگین پشتیبانی میکند عبارت است از :
```
af, ar, az, be, bg, bn, bs, ca, cs, cy, da, de, de-AT, de-CH, de-DE, el, en, en-AU, en-CA, en-GB, en-IE, en-IN, en-NZ, en-US, en-ZA, eo, es, es-419, es-AR, es-CL, es-CO, es-CR, es-EC, es-ES, es-MX, es-PA, es-PE, es-US, es-VE, et, eu, fa, fi, fr, fr-CA, fr-CH, fr-FR, gl, he, hi, hi-IN, hr, hu, id, is, it, it-CH, ja, km, kn, ko, lb, lo, lt, lv, ml, mk, mn, mr-IN, ms, nb, ne, nl, nn, or, pa, pl, pt, pt-BR, rm, ro, ru, sk, sl, sr, sv, sw, ta, th, tl, tr, tt, ug, uk, ur, uz, vi, wo, zh-CN, zh-HK, zh-TW, zh-YUE
```
به هر حال برای امکان فارسی سازی لازم است فرمان زیر را در مسیر "config/application.rb" اضافه کنید .
"در میان class موجود وارد شود"
```ruby
config.i18n.default_locale = :fa
```
حال برای ساختن کتابخانه زبانمان اقدام می کنیم . به گونه ای که در "config/locales" فایلی با نام "fa.yml" می سازیم. (به احتمال زیاد در این آدرس فایل "en.yml" قرار داشته باشد ، اما اگر نبود آن را هم برای زبان انگلیسی بسازید.
این کتابخوانه را باید با دانش لغات مورد استفاده در هر بخش آماده کنید . به فرض اگر در بخشی از پروژه قرار است مطلبی ذخیره شود ، به طبع  بخش هایی از پیش تعین شده مانند "title" یا "عنوان" ، "Article" یا "مطلب" و "Email" یا "ایمیل" و یا هر بخش دیگری که مند نظر شماست وجود خواهد داشت که هر کدام برای فهمندان کاربرانتان از آن بخش نیاز است به زبان قابل فهمشان ترجمه شود .
برای حل این مشگل شما می بایست از دستوری که جهت نمایش آن بخش استفاده میکنید بهره ببرید . خوب این یعنی اینکه زمانی که شما می خواهید کلمه عنوان را برای نمایش بخش عنوان یک قسمت در html نمایش دهید ، می بایست از دستوری شبیه به`<h1>Title</h1>` یا `<h1>عنوان</h1>` استفاده کنید . این یعنی شما در تمام بخش ها باید آن را یکسان تعریف کنید و دیگر نمی توان پویایی در پروژه مشاهده کرد . ولی می توانید در کتاب خانه تعریف کنید که چگونه می شود هر جا کلمه تعریف شده در یمل را مشاهده کردی، به جایش از "title" یا "عنوان" (بسته به زبان انتخوابی کاربر) استفاده کن.
خب دستورات i18n بسیار سده است . شما ابتدا برای انجام همین کار در کتابخانه های خود همچین دستوری را نیاز است که وارد کنید:

#####fa.yml

```
fa:
  title: "عنوان"
```
#####en.yml

```
en:
  title: "Title"
```
و سپس در بخش مورد نظر در فایل html به جای نوشتن title در تک h یا هر تگ دیگری از دستور زیر استفاده نمایید

```html
<h1><%= t(“title”) %></h1>
```
به همین ترتیب کلمات انگلیسی را در این قالب استفاده و ترجمه می کنیم.

###مدیریت کاربران و سطوح دسترسی
نرم افزارهای سمت وب هر کدام نیاز مند مدیریت کاربران و تعین سطوح دسترسی آن ها می باشند . تعین سطوح دسترسی نیاز مند فرایندی وقت گیر و نسبتا پیچیده است . 
با توجه به این امر فالیس با فراهم کردن بستری ساده در این زمینه توانسته بدون نوشتن کد و دستور کاران را مدیریت کند که در ادامه به شکل کامل شرح خواهیم داد.

- مدیریت کربران در فالیس

برای مدیریت کاربران در فالیس لازم است بدانیم هر کاربر متعلق به گروه یا گروه های خواصی است که آن گروه ها سطوح دسترسی را برای هر کاربر معین می کند . برای فهمیدن این بخش و تکمیل کردن پروژه به شکل عملی شرح خواهم داد . 
به فرض در سایت خبری ما ۳ نوع کاربر وجود دارند که عبارت است از ۱-مدیر ۲-نویسنده ۳-کاربر عادی . برای ساخت و مدیریت آن ها نیاز مند انجام مراحل زیر هستیم 

- ایجاد گروه جدید

همانگونه که گفته شد ، هر  کاربر دارای گروه های هستند که سطوح دسترسی آن ها را تعین می کند . برای ساخت آن ها باید وارد بخش گروه ها در دشبورد شویم (/dashboard/auth/groups/) . با وارد شدن به این قست شما شاهد دو گروه هستید که فالیس یه صورت پیشفرض برای شما آماده کرده است. در بالای آنها دکمه ای سبز رنگ جهت ایجاد و ساخت گروه جدید وجود دارد که بر روی آن کلیک کرده و وارد صفحه ایجاد گروه شوید .
در این صفحه شما شاهد ۴ قسمت تیین نام ، سطوح دسترسی کاربر ، سطوح دسترسی گروه ها و ذخیره یا بی خیال شدن از ساخت گروه خواهید بود . این بخش ها همان گونه از عنوانشن پیداست ، سطح دسترسی خاصی به کاربر اعطا میکند .
آبشن های مورد استفاده در دو قسمت سطوح دسترسی همه به جزع ownership مشخص هستند که چه فرایندی را برای کاربر فراهم می کند .
 آبشن Ownership به تنهایی به کاربر اجازه دستکاری مطالب یا پست های منتشر شده خودش را می دهد .  
برای پروژه خبریمان مدیرها به دسترسی کامل نیاز در هر دو بخش به جز ownership نیاز دارند که گروهی با این سبک باید برایشان ساخته شود . همچنین نویسندگان به گروه ی نیاز دارند که فقط مدیریت مطالب خودشان را به عهده داشته باشند . همچنین کاربران عادی فقط می توانند مطالب را مشاهده کنند .

- ایجاد کاربر جدید

برای ساخت تمامی کاربران به بحش کاربران رقته (/dashboard/auth/groups/new/) و روی دکمه سبز رنگ موجود کلیک کنید . این قسمت شامل بخش مشخصات فردی ، ایمل و پسورد کاربر و همچنین انتخاب گروه برای کاربر می باشد که کاملا مشخص و کاملا ساده است .

###تغییر سطح دسترسی کاربران و گروه‌ها
گاهی وقت ها پروژه جاری ما دارای چندین بخش است که لازم نیست تمام کاربران آن را مشاهده کنند . برای مثال پروژه خبری ما دو بخش (مدل) مجزا به اسم post و news_category دارد. 
برای تعین سطوح دسترسی در هر گروه باید آپشن آن موجود و قابل انتخواب باشد .
برای اینکه هر مدل را به عنوان یک آپشن دسترسی در اختیار داشته باشیم، می بایست در فایل اصلی هر مدل(/app/models/*.rb) دستور زیر را در class موجود(در خط اول درون class ) قرار دهیم .
```ruby
include Faalis::Concerns::Authorizable
```
پس از نوشتن این دستور لازم است دستور زیر را در کامند لاین وارد کنید تا در بخش edit و ایجاد گروه ها  شاهد آپشن های جدید مربوط به مدل هایتان باشید :
```{r, engine='bash', count_lines}
$ rake db:migrate
```
###معرفی  و سفارشی سازی section های فالیس
همان گونه که تا به حال پیش رفتیم فهمیدیم که فالیس یک سری قابلیت های از پیش تعین شده و آماده را برای پروژه ما ( بر اساس مدل ) فراهم می کند . 
Web App یا وب سایت توسعه داده شده توسط فالیس این قابلیت را دارد که در تمام  section های از پیش تعین شده ( index, show ,form)  را کلاً حذف کنیم یا به تعداد section هایمان سکشنی را بیفزاییم  . فالیس  تمام قسمت های دشبورد خود Sections می نامد که تمام آن ها DSL متفاوتی نسبت به هم دارند . تمام سکشن ها  چندین متد را بین خود مشترک دارند.
اول از همه شما به راه گریزی نیاز دارید تا section ها را ساخته و کنترل کنید .
این بهترین و کوتاه ترین روش برای شخصی سازی یک سکشن است . برای این کار باید در کنترلر مربوطه شخصی سازی صورت بگیرد:
```
in_<section> do |section|
  # Tweak DSL goes here . . .
end
```
بعد از جای گزاری بخش اصلی به جای <section> و بخش جدید به جای |section| و نوشتن DSL آن در میان متد می توانید آپشنی جدید جهت سفارشی کردن Section داشته باشید .
در نظر داشته باشید در قسمت فرم از Formtastic استفاده شده است، بنابر این برای شخصی سازی قسمت فرم نیاز به دانش مقدماتی از Formtastic است .
در فالیس می توان تنزیماتی چون tool_button , scope , action_button ,form attributes را در هر section اعمال کرد.

### سفارشی سازی ظاهر بخش دشبورد	

###سفارشی سازی بخش ورود و ثبت‌نام کاربر
